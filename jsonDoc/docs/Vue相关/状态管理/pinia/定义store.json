{"fileName":"å®šä¹‰store.md","dirList":["docs","Vueç›¸å…³","çŠ¶æ€ç®¡ç†","pinia"],"name":"å®šä¹‰store","createTime":1679414070449.568,"modifyTime":1679414071174.8772,"data":"# defineStoreåšäº†ä»€ä¹ˆï¼Ÿ\n\n```js\nfunction defineStore(\n  idOrOptions: any,\n  setup?: any,\n  setupOptions?: any\n) {\n  // å…¼å®¹å¤šç§ä½¿ç”¨æ–¹å¼\n  const isSetupStore = typeof setup === 'function'\n  if (typeof idOrOptions === 'string') {\n    id = idOrOptions\n    // the option store setup will contain the actual options in this case\n    options = isSetupStore ? setupOptions : setup\n  } else {\n    options = idOrOptions\n    id = idOrOptions.id\n  }\n\n  function useStore() { /* ä¸‹ä¸€èŠ‚å†çœ‹ */}\n\n  useStore.$id = id\n\n  return useStore\n}\n```\n\n# useStoreåšäº†ä»€ä¹ˆï¼Ÿ\n\n```js\nfunction useStore(pinia?: Pinia | null, hot?: StoreGeneric): StoreGeneric {\n  const currentInstance = getCurrentInstance()\n  pinia =\n    // åœ¨æµ‹è¯•æ¨¡å¼, å¿½ç•¥è¿™ä¸ªå‚æ•° ignore the argument provided as we can always retrieve a\n    // piniaå®ä¾‹ é€šè¿‡ getActivePinia() è·å–\n    (__TEST__ && activePinia && activePinia._testing ? null : pinia) ||\n    (currentInstance && inject(piniaSymbol))\n  if (pinia) setActivePinia(pinia)\n\n  if (__DEV__ && !activePinia) {\n    throw new Error(\n      `[ğŸ]: getActivePinia was called with no active Pinia. Did you forget to install pinia?\\n` +\n        `\\tconst pinia = createPinia()\\n` +\n        `\\tapp.use(pinia)\\n` +\n        `This will fail in production.`\n    )\n  }\n\n  pinia = activePinia!\n\n  if (!pinia._s.has(id)) {\n    // åˆ›é€ storeï¼Œé€šè¿‡ä¸¤ç§ä¸åŒçš„ç”¨æ³•\n    if (isSetupStore) {\n      createSetupStore(id, setup, options, pinia)\n    } else {\n      createOptionsStore(id, options as any, pinia)\n    }\n\n    /* istanbul ignore else */\n    if (__DEV__) {\n      // @ts-expect-error: not the right inferred type\n      useStore._pinia = pinia\n    }\n  }\n\n  const store: StoreGeneric = pinia._s.get(id)!\n\n  if (__DEV__ && hot) {\n    const hotId = '__hot:' + id\n    const newStore = isSetupStore\n      ? createSetupStore(hotId, setup, options, pinia, true)\n      : createOptionsStore(hotId, assign({}, options) as any, pinia, true)\n\n    hot._hotUpdate(newStore)\n\n    // cleanup the state properties and the store from the cache\n    delete pinia.state.value[hotId]\n    pinia._s.delete(hotId)\n  }\n\n  // save stores in instances to access them devtools\n  if (\n    __DEV__ &&\n    IS_CLIENT &&\n    currentInstance &&\n    currentInstance.proxy &&\n    // avoid adding stores that are just built for hot module replacement\n    !hot\n  ) {\n    const vm = currentInstance.proxy\n    const cache = '_pStores' in vm ? vm._pStores! : (vm._pStores = {})\n    cache[id] = store\n  }\n\n  // StoreGeneric cannot be casted towards Store\n  return store as any\n}\n\n```"}